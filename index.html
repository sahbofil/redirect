<!DOCTYPE html>
<html lang="ko">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-R84JKQWC71"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-R84JKQWC71');
  </script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>회원권이 소진되었습니다 ~ 사보필 ~ Redirecting...</title>
  <link rel="stylesheet" href="./css/main.css" />
</head>
<body>
  <div class="container"> 
    <img id="salgu" src="" alt="오늘의 살구" />
    <div class="msg">
    </div>
    <span class="noEp"></span>
    <ul>
      <li><a id="diritto" href="">리디:디리토 바로가기</a></li>
      <li><a id="naver" href="">네이버시리즈: 챌린지 바로가기</a></li>
    </ul>
</div>
</body>

<script>
  const images = [
    "salgu1.jpg",
    "salgu2.jpg",
    "salgu3.jpg"
  ];
  const rareChance = 0.05; // 5% 확률
  const roll = Math.random();
  const selected = roll < rareChance ? images[2] : images[Math.floor(roll * 2)];

  document.getElementById("salgu").src = `./img/${selected}`;

  let _naver = "https://novel.naver.com/challenge/detail?novelId=1182314&volumeNo=";
  let _diritto = "https://www.diritto.co.kr/contents/2402784/episodes/";
  let _epNo = "";
  const params = new URLSearchParams(window.location.search);
  const _to = params.get("to") || _diritto;
  console.log("to :: ", _to);

  const msgBox = document.querySelector('.msg');
  let count = 3;
  msgBox.innerHTML = `살구가 안내합니다.<br>${count}초 만 기다리세냥...`;

  _epNo = params.get("epNo") ?? 0;
  if (_epNo == 0) {
    document.querySelector('.noEp').innerHTML = `회차 정보가 없어 목록으로 이동합니다 ㅠ.ㅠ`;
  }
 
  _naver += _epNo;
  _diritto += _epNo;

  document.getElementById("diritto").href = _diritto;
  document.getElementById("naver").href = _naver;

  let finalURL = _to == 'naver' ? _naver : _diritto;

  const countdown = setInterval(() => {
    count--;
    msgBox.innerHTML = `살구가 안내합니다.<br>${count}초 만 기다리세냥...`;
    if (count == 0) {
      clearInterval(countdown);
      window.location.href = finalURL;
    }
  }, 1000);

</script>